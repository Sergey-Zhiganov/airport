{% extends 'base.html' %}

{% load phone_filter %}

{% block content %}
<div class="container mt-4">
    <h2>Личный кабинет</h2>

    <div class="card p-3 mb-3">
        <p><strong>ФИО:</strong>
            {{ data.last_name|default:user.last_name }}
            {{ data.first_name|default:user.first_name }}
            {% if data.middle_name %}{{ data.middle_name }}{% endif %}
        </p>
        <p><strong>Имя пользователя:</strong> {{ data.username|default:user.username }}</p>

        <p><strong>Должность:</strong>
            {% if group_names %}
                {{ group_names|join:", " }}
            {% else %}
                Сотрудник
            {% endif %}
            {% if user.is_staff %}
                <span class="badge bg-success">Доступ к админ-панели</span>
            {% endif %}
            {% if user.is_superuser %}
                <span class="badge bg-danger">Суперпользователь</span>
            {% endif %}
        </p>

        <p><strong>Email:</strong> {{ data.email|default:user.email }}</p>
        <p><strong>Телефон:</strong> {{ data.phone|default:""|format_phone }}</p>

        {% if user.is_staff %}
            <a href="{% url 'admin:index' %}" class="btn btn-primary mt-3">Перейти в админ-панель</a>
        {% endif %}

        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger mt-3 w-100">Выйти</button>
        </form>
    </div>

    <div class="d-flex flex-wrap">
        {% if perms.dbapp.view_employee %}
        <a href="{% url 'workers' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-people" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Сотрудники</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_checkindesk %}
        <a href="{% url 'check_in_desks' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-person-check" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Стойки регистрации</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_gate %}
        <a href="{% url 'gates' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-door-open" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Посадочные выходы</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_airline %}
        <a href="{% url 'airlines' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-building" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Авиакомпании</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_airplane %}
        <a href="{% url 'airplanes' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-airplane" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Самолеты</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_airport %}
        <a href="{% url 'airports' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-geo-alt" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Аэропорты</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_flight %}
        <a href="{% url 'flights' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-calendar-event" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Рейсы</div>
            </div>
        </a>
        {% endif %}

        {% if perms.dbapp.view_passenger %}
        <a href="{% url 'passengers' %}" class="card-square text-center text-decoration-none text-dark m-2">
            <div class="card p-3 d-flex flex-column align-items-center justify-content-center">
                <i class="bi bi-person" style="font-size: 2.5rem; color: #0d6efd;"></i>
                <div class="card-title mt-2 fw-bold">Пассажиры</div>
            </div>
        </a>
        {% endif %}
    </div>
</div>
{% endblock %}
